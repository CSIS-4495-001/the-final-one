(()=>{var e={};e.id=777,e.ids=[777],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9491:e=>{"use strict";e.exports=require("assert")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5158:e=>{"use strict";e.exports=require("http2")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},1576:e=>{"use strict";e.exports=require("string_decoder")},4404:e=>{"use strict";e.exports=require("tls")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},534:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>m,pages:()=>u,routeModule:()=>g,tree:()=>d});var r=s(3137),a=s(4647),o=s(4183),l=s.n(o),i=s(1775),n={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>i[e]);s.d(t,n);let c=r.AppPageRouteModule,d=["",{children:["(pages)",{children:["profile",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,9105)),"/Users/gauravmehla/Documents/code/4495/the-final-one/src/app/(pages)/profile/page.tsx"]}]},{}]},{"not-found":[()=>Promise.resolve().then(s.t.bind(s,1918,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,9197)),"/Users/gauravmehla/Documents/code/4495/the-final-one/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,1918,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["/Users/gauravmehla/Documents/code/4495/the-final-one/src/app/(pages)/profile/page.tsx"],m="/(pages)/profile/page",p={require:s,loadChunk:()=>Promise.resolve()},g=new c({definition:{kind:a.x.APP_PAGE,page:"/(pages)/profile/page",pathname:"/profile",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7079:(e,t,s)=>{Promise.resolve().then(s.bind(s,4622))},4622:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>page});var r=s(80),a=s(9885),o=s(7114),l=s(6748),i=s(4997),n=s(1522),c=s(1640),d=s(6876),u=s(8586);let addPostForm=({triggerPostRefresh:e})=>{let{user:t}=(0,l._)(),[s,o]=(0,a.useState)(""),[m,p]=(0,a.useState)(""),[g,x]=(0,a.useState)(0),[h,f]=(0,a.useState)(0),[b,v]=(0,a.useState)(""),[y,w]=(0,a.useState)([]),[j,N]=(0,a.useState)(""),[P,_]=(0,a.useState)([]),[S,q]=(0,a.useState)(!1),[A,k]=(0,a.useState)(!0),[C,E]=(0,a.useState)({lat:0,lng:0}),[I,z]=(0,a.useState)(!1),[L,D]=(0,a.useState)(!1),[U,F]=(0,a.useState)(!1),M=(0,a.useRef)(null),handleSave=async()=>{console.log(s,b,y,j,t,C);let r=await Promise.all(y.map(e=>uploadImage(e))),a=(0,u.Z)();x(1),f(0);let o={postId:a,title:s,description:b,price:m,images:r,location:j,user:t.uid,coords:C,createdAt:(0,n.Bt)(),upVotes:g,downVotes:h};console.log({newPost:o});try{let t=await (0,n.ET)((0,n.hJ)(d.db,"posts"),o);console.log("Post added with ID: ",t.id),e(),F(!0),console.log("Before closing modal"),k(!1),console.log("After closing modal")}catch(e){console.error("Error adding post: ",e)}},uploadImage=async e=>{let t=(0,c.iH)(d.tO,`posts/${Date.now()}_${e.name}`);await (0,c.KV)(t,e);let s=await (0,c.Jt)(t);return s},getLatLngFromLocation=async e=>{try{let t=await i.Z.get(`https://maps.googleapis.com/maps/api/geocode/json?address=${e}&key=AIzaSyClGrRrDVhzjZKtCfww9Y85AhJHeDaYzsA`);if(t.data.results.length>0){let{lat:e,lng:s}=t.data.results[0].geometry.location;console.log("Latitude:",e),console.log("Longitude:",s),E({lat:e,lng:s})}else console.error("Location not found")}catch(e){console.error("Error fetching location data:",e)}},handlePlaceSelect=e=>{N(e.description),_([]),getLatLngFromLocation(e.description),z(!0),D(!1)};return(0,a.useEffect)(()=>{j&&M.current&&!I&&L?window.google&&window.google.maps&&new window.google.maps.places.AutocompleteService().getPlacePredictions({input:j},e=>{_(e)}):_([])},[j,I,L]),(0,r.jsxs)("div",{className:"z-10000",children:[A&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Add a New Post"}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"title",className:"block text-gray-700 font-medium mb-2",children:"Title"}),r.jsx("input",{type:"text",id:"title",className:"w-full border rounded-lg p-2",value:s,onChange:e=>o(e.target.value)})]}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"description",className:"block text-gray-700 font-medium mb-2",children:"Description"}),r.jsx("textarea",{id:"description",className:"w-full border rounded-lg p-2",value:b,onChange:e=>v(e.target.value)})]}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"price",className:"block text-gray-700 font-medium mb-2",children:"Price"}),r.jsx("input",{type:"number",id:"price",className:"w-full border rounded-lg p-2",value:m,onChange:e=>p(e.target.value)})]}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"images",className:"block text-gray-700 font-medium mb-2",children:"Images"}),r.jsx("input",{type:"file",id:"images",multiple:!0,accept:"image/*",onChange:e=>{if(e.target.files){let t=Array.from(e.target.files);w(t)}}})]}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"location",className:"block text-gray-700 font-medium mb-2",children:"Location"}),r.jsx("input",{type:"text",id:"location",className:"w-full border rounded-lg p-2",ref:M,value:j,onChange:e=>{N(e.target.value),z(!1)},onFocus:()=>D(!0)}),P.length>0&&r.jsx("ul",{className:"bg-white border border-gray-300 rounded-lg absolute z-10 mt-2",children:P.map(e=>r.jsx("li",{onClick:()=>handlePlaceSelect(e),className:"p-2 cursor-pointer hover:bg-gray-100",children:e.description},e.place_id))})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"bg-blue-500 text-white rounded-lg px-4 py-2",onClick:handleSave,children:"Save"})})]}),S&&(0,r.jsxs)("div",{className:"fixed top-1/4 left-1/4 w-1/2 h-1/2 bg-white z-50",children:[r.jsx("div",{id:"googleMap",className:"w-full h-full"}),r.jsx("button",{onClick:()=>{q(!1)},className:"bg-blue-500 text-white rounded-lg px-4 py-2 absolute top-4 right-4",children:"Close"})]}),U&&r.jsx("div",{className:"bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md",role:"alert",children:(0,r.jsxs)("div",{className:"flex",children:[r.jsx("div",{className:"py-1",children:r.jsx("svg",{className:"fill-current h-6 w-6 text-teal-500 mr-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:r.jsx("path",{d:"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"})})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-bold",children:"Account Information"}),r.jsx("p",{className:"text-sm",children:"Post created successfully."})]})]})})]})},Posts_Post=()=>{let{user:e,isAdmin:t}=(0,l._)(),[s,o]=(0,a.useState)([]),[i,c]=(0,a.useState)(Array(s.length).fill(0));(0,a.useEffect)(()=>{let fetchUserPosts=async()=>{if(e){let s=t?(0,n.IO)((0,n.hJ)(d.db,"posts")):(0,n.IO)((0,n.hJ)(d.db,"posts"),(0,n.ar)("user","==",e.uid));try{let e=await (0,n.PL)(s);if(e.empty)console.log("No posts found for the user");else{console.log("Total posts",e.docs.length);let t=[];e.forEach(e=>{let s=e.data();t.push(s)}),o(t),c(Array(t.length).fill(0))}}catch(e){console.log("Error fetching user posts:",e)}}else console.log("Waiting for user")};fetchUserPosts()},[e]),(0,a.useEffect)(()=>{},[s]);let nextImage=e=>{c(t=>{let r=[...t];return r[e]=(r[e]+1)%(s[e]?.images?.length||1),r})},prevImage=e=>{c(t=>{let r=[...t];return r[e]=(r[e]-1+(s[e]?.images?.length||1))%(s[e]?.images?.length||1),r})},handleDelete=async e=>{if(console.log("Deleting post with ID:",e),window.confirm("Are you sure you want to delete this post?"))try{let t=(0,n.IO)((0,n.hJ)(d.db,"posts"),(0,n.ar)("postId","==",e)),s=await (0,n.PL)(t);if(s.empty)console.error("Document does not exist");else{let t=s.docs[0],r=t.data(),a=(0,n.JU)(d.db,"deletedPosts",e);await (0,n.pl)(a,r),await (0,n.oe)(t.ref),o(t=>{let s=t.filter(t=>t.postId!==e);return s})}}catch(e){console.error("Error deleting document: ",e)}};return r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 text-black mx-auto max-w-screen-lg px-8 pt-5 pb-3",children:s.map((e,t)=>(0,r.jsxs)("div",{className:"bg-white shadow-md rounded-md overflow-hidden relative",children:[r.jsx("button",{onClick:()=>e.postId&&handleDelete(e.postId),className:"bg-gray-200 text-gray-700 p-2 absolute",style:{zIndex:10},children:"\xd7"}),e.images&&e.images.length>0&&(0,r.jsxs)("div",{className:"relative",children:[r.jsx("img",{className:"w-full h-60 object-cover rounded-t-md",src:e.images[i[t]],alt:`Image ${i[t]}`}),e.images.length>1&&(0,r.jsxs)("div",{className:"absolute top-0 right-0 flex items-center space-x-2",children:[r.jsx("button",{onClick:()=>prevImage(t),className:"bg-gray-200 text-gray-700 p-2",children:"<"}),r.jsx("button",{onClick:()=>nextImage(t),className:"bg-gray-200 text-gray-700 p-2",children:">"})]})]}),(0,r.jsxs)("div",{className:"p-4",children:[r.jsx("h1",{className:"text-xl font-semibold mb-2 text-gray-900",children:e.title}),r.jsx("p",{className:"text-gray-700 mb-4",children:e.description}),(0,r.jsxs)("div",{className:"flex items-center text-gray-600",children:[r.jsx("svg",{height:"15pt",viewBox:"0 0 24 24",width:"15pt",xmlns:"http://www.w3.org/2000/svg",fill:"#000000",children:r.jsx("path",{d:"M18,4.48a8.45,8.45,0,0,0-12,12l5.27,5.28a1,1,0,0,0,1.42,0L18,16.43A8.45,8.45,0,0,0,18,4.48ZM16.57,15,12,19.59,7.43,15a6.46,6.46,0,1,1,9.14,0ZM9,7.41a4.32,4.32,0,0,0,0,6.1,4.31,4.31,0,0,0,7.36-3,4.24,4.24,0,0,0-1.26-3.05A4.3,4.3,0,0,0,9,7.41Zm4.69,4.68a2.33,2.33,0,1,1,.67-1.63A2.33,2.33,0,0,1,13.64,12.09Z"})}),r.jsx("p",{className:"ml-2 text-sm",children:e.location})]}),(0,r.jsxs)("p",{className:"text-green-900 font-semibold text-lg mt-4",children:["$",e.price]})]})]},t))})},page=()=>{let{user:e}=(0,l._)(),[t,s]=(0,a.useState)(!0);(0,o.useRouter)();let[i,c]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!1),[p,g]=(0,a.useState)({latitude:0,longitude:0}),closeModal=()=>c(!1);(0,a.useEffect)(()=>{let checkAuthentication=async()=>{s(!1)};null!==e&&checkAuthentication(),"geolocation"in navigator?navigator.geolocation.getCurrentPosition(e=>{let{latitude:t,longitude:s}=e.coords;g({latitude:t,longitude:s})},e=>{console.error("Error getting location:",e)}):console.error("Geolocation is not supported"),fetchUserPosts()},[e,u]);let fetchUserPosts=async()=>{if(e)try{let t=(0,n.IO)((0,n.hJ)(d.db,"posts"),(0,n.ar)("user","==",e.uid));await (0,n.PL)(t)}catch(e){console.error("Error fetching user posts:",e)}else console.log("Waiting for user")};return(0,r.jsxs)("div",{className:"max-w-full sm:mx-auto md:mx-auto lg:mx-auto xl:mx-auto mt-16 shadow-xl text-gray-900 bg-gray-700 min-h-screen",children:[r.jsx("div",{className:"mx-auto w-48 h-48 relative -mt-16 border-4 border-gray-700 shadow-md rounded-full overflow-hidden bg-gray-700 ring-2 ring-blue-700 ring-opacity-100",children:r.jsx("img",{className:"object-cover object-center h-48 w-48 mix-blend",src:e?.photoURL||"https://img.icons8.com/?size=256&id=tZuAOUGm9AuS&format=png",alt:"User profile"})}),(0,r.jsxs)("div",{className:"text-center mt-2",children:[r.jsx("h2",{className:"text-white font-semibold",style:{fontSize:"1.5em"},children:e?.displayName||e?.email.split("@")[0]}),r.jsx("p",{className:"text-gray-400 text-black",children:"User"})]}),(0,r.jsxs)("div",{className:"p-4 border-t mx-8 mt-2 z-1000 shadow-lg",children:[r.jsx("button",{className:"w-1/4 block mx-auto rounded-full bg-gray-900 font-semibold text-white px-4 py-1 shadow-lg ring-2 ring-gray-400 ring-opacity-100 transform transition-transform duration-100 hover:scale-105",onClick:()=>c(!0),children:"Create Post"}),i&&r.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e=>{i&&e.target===e.currentTarget&&closeModal()},children:r.jsx("div",{className:"bg-white p-8 rounded-md",children:r.jsx(addPostForm,{triggerPostRefresh:()=>{m(e=>!e)}})})})]}),r.jsx(Posts_Post,{},u.toString())]})}},9105:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>o,default:()=>n});var r=s(7536);let a=(0,r.createProxy)(String.raw`/Users/gauravmehla/Documents/code/4495/the-final-one/src/app/(pages)/profile/page.tsx`),{__esModule:o,$$typeof:l}=a,i=a.default,n=i},3881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var r=s(6885);let __WEBPACK_DEFAULT_EXPORT__=e=>{let t=(0,r.fillMetadataSegment)(".",e.params,"favicon.ico");return[{type:"image/x-icon",sizes:"16x16",url:t+""}]}}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[997,885,535,373],()=>__webpack_exec__(534));module.exports=s})();