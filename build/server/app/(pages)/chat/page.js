(()=>{var e={};e.id=223,e.ids=[223],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5158:e=>{"use strict";e.exports=require("http2")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},1576:e=>{"use strict";e.exports=require("string_decoder")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},7680:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>h,originalPathname:()=>p,pages:()=>u,routeModule:()=>x,tree:()=>d});var r=s(3137),a=s(4647),i=s(4183),n=s.n(i),o=s(1775),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(t,l);let c=r.AppPageRouteModule,d=["",{children:["(pages)",{children:["chat",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4215)),"/Users/gauravmehla/Documents/code/4495/the-final-one/src/app/(pages)/chat/page.tsx"]}]},{}]},{"not-found":[()=>Promise.resolve().then(s.t.bind(s,1918,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,9197)),"/Users/gauravmehla/Documents/code/4495/the-final-one/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,1918,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["/Users/gauravmehla/Documents/code/4495/the-final-one/src/app/(pages)/chat/page.tsx"],p="/(pages)/chat/page",h={require:s,loadChunk:()=>Promise.resolve()},x=new c({definition:{kind:a.x.APP_PAGE,page:"/(pages)/chat/page",pathname:"/chat",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},5419:(e,t,s)=>{Promise.resolve().then(s.bind(s,883))},883:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>chat_page});var r=s(80),a=s(9885),i=s.n(a),n=s(7114),o=s(6748);let components_ChatNavbar=()=>r.jsx("div",{className:"bg-gray-800 p-4 text-white rounded-t-lg",children:r.jsx("h2",{className:"text-lg font-semibold",children:"Chats"})});var l=s(1522),c=s(6876),d=s(6160);let components_Chats=()=>{let[e,t]=i().useState({}),{user:s}=(0,o._)(),{dispatch:n}=(0,d.Q)();(0,a.useEffect)(()=>{console.log("user => ",s),s&&(()=>{let e=(0,l.JU)(c.db,"userChats",s.uid);t({}),(0,l.QT)(e).then(s=>{s.exists()&&(console.log("Document already exists:",s.data()),t(s.data()));let r=(0,l.cf)(e,e=>{t(e.data()),console.log("chats => ",e.data())});return()=>{r()}}).catch(e=>{console.error("Error checking document:",e)})})()},[s]);let capitalizeFirstLetter=e=>e.replace(/\b\w/g,e=>e.toUpperCase()),handleSelect=async e=>{console.log("handleSelect => ",e),n({type:"CHANGE_USER",payload:e})};return r.jsx(r.Fragment,{children:e?Object.entries(e).map(([e,t])=>r.jsx("div",{className:"flex items-center p-3 hover:bg-gray-700 cursor-pointer shadow-md text-white bg-gray-800",onClick:()=>handleSelect(t.userInfo),children:(0,r.jsxs)("div",{className:"flex items-center justify-center mt-4 hover:bg-gray-700 cursor-pointer",children:[(0,r.jsxs)("div",{className:"bg-blue-500 text-white rounded-full h-12 w-12 flex items-center justify-center text-lg font-bold",children:[r.jsx("span",{children:t.userInfo.displayName[0].toUpperCase()}),t.userInfo.displayName.includes(" ")&&r.jsx("span",{children:t.userInfo.displayName.split(" ")[1][0].toUpperCase()})]}),(0,r.jsxs)("div",{className:"ml-2",children:[r.jsx("div",{children:capitalizeFirstLetter(t.userInfo.displayName)}),r.jsx("div",{className:"text-sm text-gray-500",children:t.lastMessage?.text})]})]})},e)):"Loading..."})},components_ChatSearch=()=>{let[e,t]=i().useState(""),[s,a]=i().useState(null),[n,d]=i().useState(!1),{user:u}=(0,o._)(),handleSelect=async()=>{if(s){let e=u.uid>s.uid?u.uid+s.uid:s.uid+u.uid;console.log("combineId => ",e);try{let t=await (0,l.QT)((0,l.JU)(c.db,"chats",e));t.exists()||(await (0,l.pl)((0,l.JU)(c.db,"chats",e),{messages:[]}),await (0,l.r7)((0,l.JU)(c.db,"userChats",u.uid),{[e+".userInfo"]:{uid:s.uid,displayName:s.displayName},[e+".date"]:(0,l.Bt)()}),await (0,l.r7)((0,l.JU)(c.db,"userChats",s.uid),{[e+".userInfo"]:{uid:u.uid,displayName:u.displayName},[e+".date"]:(0,l.Bt)()}),console.log("user connection created"))}catch(e){console.log(e)}}a(null),t("")};return(0,r.jsxs)("div",{className:"text-center",children:[n&&r.jsx("p",{className:"text-red-500 text-lg font-bold",children:"User not found"}),s&&(0,r.jsxs)("div",{className:"flex items-center justify-center mt-4 hover:bg-gray-700 cursor-pointer rounded-md p-2 transition-colors duration-200 text-white",onClick:handleSelect,children:[(0,r.jsxs)("div",{className:"bg-blue-500 text-white rounded-full h-12 w-12 flex items-center justify-center text-lg font-bold",children:[r.jsx("span",{children:s.displayName[0].toUpperCase()}),s.displayName.includes(" ")&&r.jsx("span",{children:s.displayName.split(" ")[1][0].toUpperCase()})]}),r.jsx("div",{className:"ml-2 text-lg font-semibold",children:s.displayName})]})]})},components_ChatSidebar=()=>(0,r.jsxs)("div",{children:[r.jsx(components_ChatNavbar,{}),r.jsx(components_ChatSearch,{}),r.jsx(components_Chats,{})]});var u=s(6857);let chat_page=()=>{let{user:e}=(0,o._)(),t=(0,n.useRouter)();return(0,a.useEffect)(()=>{e||t.push("/")}),(0,r.jsxs)("div",{className:"flex p-4 bg-gray-700 text-white",children:[r.jsx("div",{className:"w-1/4 pr-4 p-2",children:r.jsx(components_ChatSidebar,{})}),r.jsx("div",{className:"w-3/4",children:r.jsx("div",{className:"bg-gray-700 p-1 rounded-lg shadow text-white",style:{height:"calc(100vh - 102px)"},children:r.jsx(u.Z,{})})})]})}},4215:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>i,default:()=>l});var r=s(7536);let a=(0,r.createProxy)(String.raw`/Users/gauravmehla/Documents/code/4495/the-final-one/src/app/(pages)/chat/page.tsx`),{__esModule:i,$$typeof:n}=a,o=a.default,l=o},3881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var r=s(6885);let __WEBPACK_DEFAULT_EXPORT__=e=>{let t=(0,r.fillMetadataSegment)(".",e.params,"favicon.ico");return[{type:"image/x-icon",sizes:"16x16",url:t+""}]}}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[997,885,373],()=>__webpack_exec__(7680));module.exports=s})();