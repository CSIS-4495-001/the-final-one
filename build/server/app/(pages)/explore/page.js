(()=>{var e={};e.id=752,e.ids=[752],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5158:e=>{"use strict";e.exports=require("http2")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},1576:e=>{"use strict";e.exports=require("string_decoder")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},4671:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>y,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>p});var o=r(3137),s=r(4647),l=r(4183),a=r.n(l),i=r(1775),n={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>i[e]);r.d(t,n);let d=o.AppPageRouteModule,p=["",{children:["(pages)",{children:["explore",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,2538)),"/Users/gauravmehla/Documents/code/4495/the-final-one/src/app/(pages)/explore/page.tsx"]}]},{}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,1918,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,9197)),"/Users/gauravmehla/Documents/code/4495/the-final-one/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,1918,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/gauravmehla/Documents/code/4495/the-final-one/src/app/(pages)/explore/page.tsx"],u="/(pages)/explore/page",y={require:r,loadChunk:()=>Promise.resolve()},m=new d({definition:{kind:s.x.APP_PAGE,page:"/(pages)/explore/page",pathname:"/explore",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:p}})},7547:(e,t,r)=>{Promise.resolve().then(r.bind(r,8607))},8607:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>explore_page});var o=r(80),s=r(9885),l=r.n(s),a=r(6748);let RecenterControl=class RecenterControl{constructor(e,t,r){let o=document.createElement("div");o.style.backgroundColor="#fff",o.style.marginRight="0px",o.style.margin="10px",o.style.marginTop="20px",o.style.border="1px solid #ccc",o.style.borderRadius="3px",o.style.boxShadow="0 2px 6px rgba(0, 0, 0, 0.3)",o.style.cursor="pointer",o.style.textAlign="center",o.title="Click to recenter the map",e.appendChild(o);let s=document.createElement("div");s.style.color="rgb(25,25,25)",s.style.fontFamily="Roboto,Arial,sans-serif",s.style.fontSize="12px",s.style.lineHeight="29px",s.style.paddingLeft="5px",s.style.paddingRight="5px",s.innerHTML="Recenter",o.appendChild(s),o.addEventListener("click",()=>{t.setCenter(r)})}};let i=[{elementType:"geometry",stylers:[{color:"#1d2c4d"}]},{elementType:"labels.text.fill",stylers:[{color:"#8ec3b9"}]},{elementType:"labels.text.stroke",stylers:[{color:"#1a3646"}]},{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{color:"#4b6878"}]},{featureType:"administrative.land_parcel",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#64779e"}]},{featureType:"administrative.province",elementType:"geometry.stroke",stylers:[{color:"#4b6878"}]},{featureType:"landscape.man_made",elementType:"geometry.stroke",stylers:[{color:"#334e87"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#023e58"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#283d6a"}]},{featureType:"poi",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#6f9ba5"}]},{featureType:"poi",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"poi.business",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#023e58"}]},{featureType:"poi.park",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#3C7680"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#304a7d"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#98a5be"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#2c6675"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#255763"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#b0d5ce"}]},{featureType:"road.highway",elementType:"labels.text.stroke",stylers:[{color:"#023e58"}]},{featureType:"road.local",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels.text.fill",stylers:[{color:"#98a5be"}]},{featureType:"transit",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"transit.line",elementType:"geometry.fill",stylers:[{color:"#283d6a"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#3a4762"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#0e1626"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#4e6d70"}]}];var n=r(6876),d=r(1522);function deg2rad(e){return e*(Math.PI/180)}var p=r(4751);r(5996);let FilterControl=class FilterControl{constructor(e,t,r,o){let s=document.createElement("div");s.style.backgroundColor="#fff",s.style.border="1px solid #ccc",s.style.borderRadius="3px",s.style.boxShadow="0 2px 6px rgba(0, 0, 0, 0.3)",s.style.cursor="pointer",s.style.textAlign="center",s.style.margin="10px",s.style.marginTop="20px",s.style.width="100px",s.style.height="29px",s.title="Click to set the circle radius",e.appendChild(s);let l=document.createElement("select");l.style.width="100%",l.style.height="100%",l.style.fontSize="12px",l.style.border="none",["1","2","5","10","20","30"].forEach(e=>{let t=document.createElement("option");t.value=e,t.text=e+" km",l.appendChild(t)}),s.appendChild(l),l.value=o.toString(),l.addEventListener("change",()=>{r(Number(l.value))})}};let PriceControl=class PriceControl{constructor(e,t,r,o){let s=document.createElement("div");s.style.backgroundColor="#f8f8f8",s.style.border="1px solid #ddd",s.style.borderRadius="5px",s.style.boxShadow="0 2px 6px rgba(0, 0, 0, 0.1)",s.style.padding="10px",s.style.display="flex",s.style.flexDirection="column",s.innerHTML="Enter the price range",s.style.marginTop="60px",e.appendChild(s);let l=document.createElement("div");l.style.display="flex",l.style.marginBottom="10px",s.appendChild(l);let a=this.createInput("Min Price",r),i=this.createInput("Max Price",o);l.appendChild(a),l.appendChild(i);let n=document.createElement("button");n.innerText="Apply",n.style.width="105px",n.style.fontSize="12px",n.style.border="none",n.style.cursor="pointer",n.style.backgroundColor="#007bff",n.style.color="#fff",n.style.padding="8px",n.style.borderRadius="3px",s.appendChild(n),n.addEventListener("click",()=>{let e=Number(a.value),r=Number(i.value);t(e,r)})}createInput(e,t){let r=document.createElement("input");r.type="number",r.placeholder=e,r.style.width="50px",r.style.height="30px",r.style.fontSize="12px",r.style.border="1px solid #ddd",r.style.borderRadius="3px",r.style.padding="5px",r.style.marginRight="5px",r.style.marginTop="5px",r.style.appearance="none",r.value=t.toString();let o=document.createElement("style");return o.innerHTML=`
        input[type="number"]::-webkit-inner-spin-button { 
            display: none;
        }`,document.head.appendChild(o),r}};let{v4:c}=r(1768),explore_page=()=>{let e;let{user:t}=(0,a._)(),[r,u]=(0,s.useState)({lat:49.273282,lng:-123.104274}),[y,m]=(0,s.useState)(5),[g,x]=(0,s.useState)(0),[f,h]=(0,s.useState)(100),b=c(),[v,T]=l().useState(null),[C,w]=(0,s.useState)(null),[k,P]=(0,s.useState)(!1),[E,_]=(0,s.useState)("na"),[q,O]=(0,s.useState)([]),getSelecedUser=async e=>{console.log("selectedUid => ",e);let t=(0,d.IO)((0,d.hJ)(n.db,"users"),(0,d.ar)("uid","==",e));try{let e=await (0,d.PL)(t);console.log(e),e.empty?T(null):(e.forEach(e=>{T(e.data()),console.log(e.id," DOCC => ",e.data())}),console.log("Nuser => ",v))}catch(e){console.log(e)}};(0,s.useEffect)(()=>{console.log("Nuser => ",v);let createChat=async()=>{if(console.log("searching for Nuser with username: ",v?.displayName.trim()),v){let e=t.uid>v.uid?t.uid+v.uid:v.uid+t.uid;console.log("combineId => ",e);let r=await (0,d.QT)((0,d.JU)(n.db,"chats",e)),o=await (0,d.QT)((0,d.JU)(n.db,"userChats",t.uid)),s=await (0,d.QT)((0,d.JU)(n.db,"userChats",v.uid));r.exists()?(await (0,d.r7)((0,d.JU)(n.db,"chats",e),{messages:(0,d.vr)({id:b,text:E,senderId:t.uid,date:d.EK.now()})}),p.Am.info("Chat already exists, message has been sent!",{position:"bottom-left",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark"})):(await (0,d.pl)((0,d.JU)(n.db,"chats",e),{messages:(0,d.vr)({id:b,text:E,senderId:t.uid,date:d.EK.now()})}),o.exists()||await (0,d.pl)((0,d.JU)(n.db,"userChats",t.uid),{[e]:{userInfo:{uid:v.uid,displayName:v.displayName},date:(0,d.Bt)()}}),s.exists()||await (0,d.pl)((0,d.JU)(n.db,"userChats",v.uid),{[e]:{userInfo:{uid:t.uid,displayName:t.displayName},date:(0,d.Bt)()}}),await (0,d.r7)((0,d.JU)(n.db,"userChats",t.uid),{[e+".userInfo"]:{uid:v.uid,displayName:v.displayName},[e+".date"]:(0,d.Bt)()}),await (0,d.r7)((0,d.JU)(n.db,"userChats",v.uid),{[e+".userInfo"]:{uid:t.uid,displayName:t.displayName},[e+".date"]:(0,d.Bt)()}),p.Am.success("Connection Created, Go to chat page to talk",{position:"bottom-left",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark"}))}T(null)};v&&createChat()},[v,E]);let handleSelect=async e=>{await getSelecedUser(e)},handleReport=async(e,r)=>{let o=(0,d.IO)((0,d.hJ)(n.db,"posts"),(0,d.ar)("postId","==",e)),s=await (0,d.QT)((0,d.JU)(n.db,"reportedPosts",e));try{let l=await (0,d.PL)(o);if(console.log(l),l.empty)p.Am.error("Error Reporting Post, Please try again.",{position:"bottom-left",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark"});else{if(s.exists()){let o=s.data()?.reportedBy.includes(t.uid);if(o){p.Am.error("You have already reported this post.",{position:"bottom-left",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark"});return}await (0,d.r7)((0,d.JU)(n.db,"reportedPosts",e),{reportedBy:[...s.data()?.reportedBy,t.uid],reason:[...s.data()?.reason,r]})}else await (0,d.pl)((0,d.JU)(n.db,"reportedPosts",e),{reportedBy:[t.uid],reason:[r],postDetails:l.docs[0].data()});p.Am.success("Post Reported, Thank you for your feedback.",{position:"bottom-left",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark"})}}catch(e){console.log(e)}};return(0,s.useEffect)(()=>{let e;let t=document.getElementById("map");if(t){if(e=new google.maps.Map(t,{zoom:k?15:12,center:r,styles:i,minZoom:2,gestureHandling:"cooperative",mapTypeControl:!1,disableDefaultUI:!0,streetViewControl:!0}),k){let t={path:google.maps.SymbolPath.CIRCLE,fillColor:"#269bf3",fillOpacity:1,scale:6,strokeColor:"white",strokeWeight:1};new google.maps.Marker({position:r,icon:t,map:e})}let o=document.createElement("div");new RecenterControl(o,e,r),e.controls[google.maps.ControlPosition.TOP_CENTER].push(o);let s=new google.maps.Circle({strokeColor:"#00FF00",strokeOpacity:.1,strokeWeight:2,fillColor:"#00FF00",fillOpacity:.1,map:e,center:r,radius:1e3*y,zIndex:1}),l=document.createElement("div"),a=document.createElement("div");new FilterControl(l,e,e=>{m(e),s.setRadius(1e3*e)},y),new PriceControl(a,(e,t)=>{x(e),h(t)},g,f),e.controls[google.maps.ControlPosition.TOP_CENTER].push(l),a.style.display="none",e.controls[google.maps.ControlPosition.TOP_CENTER].push(a);let n=document.createElement("div");n.innerHTML="more ▼",n.style.backgroundColor="#fff",n.style.color="#000",n.style.padding="8px 16px",n.style.border="none",n.style.borderRadius="4px",n.style.cursor="pointer",n.style.margin="10px",n.style.marginTop="20px",n.addEventListener("click",()=>{n.textContent="more ▼"===n.textContent?"less ▲":"more ▼",a.style.display="none"===a.style.display?"block":"none"}),e.controls[google.maps.ControlPosition.TOP_CENTER].push(n);let d=null;q.forEach((t,r)=>{let o=new google.maps.Marker({position:{lat:t.coords.lat,lng:t.coords.lng},map:e});o.addListener("click",()=>{d&&d.close();let s=new google.maps.InfoWindow({content:`
              <div style="max-width: 300px; margin: 0 auto; background-color: #ffffff; padding: 16px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); font-family: Arial, sans-serif;">
              <h2 style="font-size: 1.5rem; font-weight: bold; margin-bottom: 8px; color: #0e1626; overflow: auto; height: 32px;">${t.title}</h2>
              <hr style="border: none; border-top: 1px solid #ddd; margin: 8px 0;">
              <p>Description:</p>
              <div style="background-color: #f0f0f0; padding: 10px; overflow: auto; height: 50px; border-radius: 4px; margin-top: 10px; margin-bottom: 10px">
              <p style="font-size: 0.8rem; color: black; margin-bottom: 8px;">
                ${t.description}
              </p>
            </div>
            
              <div style="white-space: nowrap; overflow-x: auto; margin-bottom: 8px;">
              ${t.images.map(e=>`<div style="display: inline-block; width: 100px; height: 100px; overflow: hidden; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); margin-right:15px">
                      <img src="${e}" alt="Post image" style="width: 100%; height: 100%; object-fit: cover; object-position: center;"/>
                    </div>`).join("")}
            </div>
            
            <p style="font-size: 1rem; color: green; margin-top: 10px; margin-bottom:10px ">$ ${t.price}</p>   

                <p style="font-size: 0.6rem; color: #555; margin-bottom: 8px; overflow: auto;">Location: ${t.location}</p>

                <div style="display: flex; gap: 8px;">
                  <button style="background-color: #3498db; color: #fff; padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); transition: background-color 0.3s ease;" id="selectButton${r}" value="${t.user}" onmouseover="this.style.backgroundColor='#2980b9';" onmouseout="this.style.backgroundColor='#3498db';">Message</button>
          
                  <button style="background-color: #e74c3c; color: #fff; padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); transition: background-color 0.3s ease;" id="reportButton${r}" value="${t.postId}" onmouseover="this.style.backgroundColor='#c0392b';" onmouseout="this.style.backgroundColor='#e74c3c';">Report</button>
                </div>
              </div>
            `});google.maps.event.addListenerOnce(s,"domready",()=>{let e=document.getElementById(`selectButton${r}`);e&&e.addEventListener("click",()=>{console.log("selectButton clicked");let r=e?.getAttribute("value");console.log("selectedUid => ",r);let o=prompt("Please enter your message:","Hi, I am interested in your post!");o&&(handleSelect(r),_("Title - "+t.title+"\nDescription - "+t.description+"\nPrice - $ "+t.price+"\n-------------\n\n"+o)),s.close()})}),google.maps.event.addListenerOnce(s,"domready",()=>{let e=document.getElementById(`reportButton${r}`);e&&e.addEventListener("click",()=>{console.log("reportButton clicked");let t=e?.getAttribute("value");if(console.log("selectedPostValue => ",t),t){let e=prompt("Please enter the reason for reporting:");e&&handleReport(t,e)}s.close()})}),s.open(e,o),d=s})})}},[r,k,q]),(0,s.useEffect)(()=>("geolocation"in navigator?(k||void 0!=e||(e=(0,p.Am)("Fetching user location...",{position:"bottom-left",autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark"})),navigator.geolocation.getCurrentPosition(t=>{let{latitude:r,longitude:o}=t.coords;u({lat:r,lng:o}),k||p.Am.dismiss(e),P(!0)},e=>{console.error("Error getting location:",e)})):(P(!1),console.error("Geolocation is not supported")),()=>{P(!1)}),[]),(0,s.useEffect)(()=>{if(k){let fetchData=async()=>{let e=(0,d.ad)(),o=(0,d.hJ)(e,"posts"),s=await (0,d.PL)(o),l=[];s.forEach(e=>{let o=e.data(),s=function(e,t,r,o){let s=deg2rad(r-e),l=deg2rad(o-t),a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(deg2rad(e))*Math.cos(deg2rad(r))*Math.sin(l/2)*Math.sin(l/2);return 6371*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))}(r.lat,r.lng,o.coords.lat,o.coords.lng);s<=y&&o.user!=t.uid&&o.price>=g&&o.price<=f&&l.push(o)}),O(l),console.log("nearbyPosts => ",l)};fetchData()}},[r,y,g,f]),o.jsx("div",{className:"flex flex-1 items-center justify-center",children:(0,o.jsxs)("div",{className:"w-full",children:[o.jsx(p.Ix,{}),o.jsx("div",{className:"",children:o.jsx("div",{id:"map",style:{width:"100%",height:"91vh"}})})]})})}},2538:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>a,__esModule:()=>l,default:()=>n});var o=r(7536);let s=(0,o.createProxy)(String.raw`/Users/gauravmehla/Documents/code/4495/the-final-one/src/app/(pages)/explore/page.tsx`),{__esModule:l,$$typeof:a}=s,i=s.default,n=i},3881:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var o=r(6885);let __WEBPACK_DEFAULT_EXPORT__=e=>{let t=(0,o.fillMetadataSegment)(".",e.params,"favicon.ico");return[{type:"image/x-icon",sizes:"16x16",url:t+""}]}}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[997,885,373],()=>__webpack_exec__(4671));module.exports=r})();