(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[952],{325:function(e,t,s){Promise.resolve().then(s.bind(s,3120))},3120:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return page}});var a=s(7437),r=s(2265),l=s(4031),n=s(4086),o=s(6085),components_InfoBanner=()=>(0,a.jsx)("div",{className:"bg-blue-500 text-white py-4 text-center",children:(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[(0,a.jsx)("img",{src:"https://firebase.google.com/static/images/brand-guidelines/logo-logomark.png",alt:"Firebase Logo",className:"w-8 h-8 mr-2"}),(0,a.jsxs)("p",{className:"font-semibold text-lg",children:["Need more information? Visit our"," ",(0,a.jsx)("a",{href:"https://firebase.com",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Firebase account"})]})]})}),page=()=>{let{user:e}=(0,l._)(),[t,s]=(0,r.useState)(0),[i,c]=(0,r.useState)(0),[d,u]=(0,r.useState)(0),[h,m]=(0,r.useState)(0);return(0,r.useEffect)(()=>{let fetchTotalUsers=async()=>{if(e)try{let e=(0,n.hJ)(o.db,"users"),t=await (0,n.PL)(e);s(t.size)}catch(e){console.error("Error fetching total users: ",e)}},fetchTotalPosts=async()=>{if(e)try{let e=(0,n.hJ)(o.db,"posts"),t=await (0,n.PL)(e);c(t.size)}catch(e){console.error("Error fetching total posts: ",e)}},fetchTotalDeletedPosts=async()=>{if(e)try{let e=(0,n.hJ)(o.db,"deletedPosts"),t=await (0,n.PL)(e);u(t.size)}catch(e){console.error("Error fetching total deleted posts: ",e)}},fetchTotalReportedPosts=async()=>{if(e)try{let e=(0,n.hJ)(o.db,"reportedPosts"),t=await (0,n.PL)(e);m(t.size)}catch(e){console.error("Error fetching total reported posts: ",e)}};fetchTotalUsers(),fetchTotalPosts(),fetchTotalDeletedPosts(),fetchTotalReportedPosts()},[e]),(0,a.jsx)("div",{className:"flex flex-1 items-center justify-center p-6",children:(0,a.jsx)("div",{className:"w-full",children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Admin Dashboard"}),(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-200 p-4 rounded-md",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Total Users"}),(0,a.jsx)("p",{children:t})]}),(0,a.jsxs)("div",{className:"bg-gray-200 p-4 rounded-md",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Total Posts"}),(0,a.jsx)("p",{children:i})]}),(0,a.jsxs)("div",{className:"bg-gray-200 p-4 rounded-md",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Total Deleted Posts"}),(0,a.jsx)("p",{children:d})]}),(0,a.jsxs)("div",{className:"bg-gray-200 p-4 rounded-md",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Total Reported Posts"}),(0,a.jsx)("p",{children:h})]}),(0,a.jsx)(components_InfoBanner,{})]})]})})})}},2209:function(e,t,s){"use strict";s.d(t,{Z:function(){return components_Chat}});var a=s(7437),r=s(2265),l=s(4031),n=s(9213),components_ChatMessage=e=>{let{message:t}=e,s=!1,{user:o}=(0,l._)(),{data:i}=(0,n.Q)(),c=(0,r.useRef)(null);(0,r.useEffect)(()=>{var e;null===(e=c.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[t]);let d=new Date(1e3*t.date.seconds);return s=!!o&&t.senderId===o.uid,(0,a.jsxs)("div",{ref:c,className:"flex ".concat(s?"justify-end":"justify-start"," items-center mb-4 ml-2 mr-2"),children:[s&&(0,a.jsx)("p",{className:"text-xs text-gray-400 ml-2 mr-2",children:d.toLocaleString()}),(0,a.jsxs)("div",{className:"max-w-[70%] p-3 rounded-lg ".concat(s?"bg-gray-800 text-white shadow-lg":"bg-gray-400 text-black shadow-lg"," ").concat(s?"float-right":"float-left"),children:[t.text.split("\n").map((e,t)=>(0,a.jsx)("p",{children:e},t)),t.image&&(0,a.jsx)("img",{src:null==t?void 0:t.image,alt:"",className:"mt-2 rounded-md w-full h-auto"})]}),!s&&(0,a.jsx)("p",{className:"text-xs text-gray-500 ml-2 mr-2",children:d.toLocaleString()})]})},o=s(4086),i=s(6085),components_ChatMessages=()=>{let[e,t]=(0,r.useState)([]),{data:s}=(0,n.Q)();return(0,r.useEffect)(()=>{let e=(0,o.cf)((0,o.JU)(i.db,"chats",s.chatId),e=>{e.exists()&&t(e.data().messages)});return()=>{e()}},[s.chatId]),console.log("messages => ",e),(0,a.jsx)("div",{children:e.map(e=>(0,a.jsx)(components_ChatMessage,{message:e},e.id))})},c=s(9584);let{v4:d}=s(4916);var components_ChatInput=()=>{let e=d(),[t,s]=(0,r.useState)(" "),[u,h]=(0,r.useState)(null),[m,g]=(0,r.useState)(!1),{user:x}=(0,l._)(),{data:p}=(0,n.Q)(),handleSend=async()=>{if(u){let s=(0,c.iH)(i.tO,"chats/"+e),a=(0,c.B0)(s,u);a.on("state_changed",e=>{},e=>{console.error(e)},()=>{(0,c.Jt)(a.snapshot.ref).then(async s=>{await (0,o.r7)((0,o.JU)(i.db,"chats",p.chatId),{messages:(0,o.vr)({id:e,text:t,senderId:x.uid,date:o.EK.now(),image:s})})})})}else await (0,o.r7)((0,o.JU)(i.db,"chats",p.chatId),{messages:(0,o.vr)({id:e,text:t,senderId:x.uid,date:o.EK.now()})});await (0,o.r7)((0,o.JU)(i.db,"userChats",x.uid),{[p.chatId+".lastMessage"]:{text:t},[p.chatId+".date"]:(0,o.Bt)()}),await (0,o.r7)((0,o.JU)(i.db,"userChats",p.Nuser.uid),{[p.chatId+".lastMessage"]:{text:t},[p.chatId+".date"]:(0,o.Bt)()}),s(""),h(null),g(!1)},handleImageChange=e=>{var t;let s=(null===(t=e.target.files)||void 0===t?void 0:t[0])||null;h(s)};return(0,a.jsxs)("div",{className:"bottom-0 left-0 w-full bg-gray-700 flex items-center ",children:[(0,a.jsx)("input",{type:"text",placeholder:"Enter your message...",className:"w-full border border-gray-800 p-4 mr-2 rounded focus:outline-none focus:border-gray-500 text-white bg-gray-800",onChange:e=>s(e.target.value),onKeyDown:e=>{"Enter"===e.key&&handleSend()},value:t}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("label",{htmlFor:"file",className:"cursor-pointer",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-800 hover:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),(0,a.jsx)("input",{type:"file",style:{display:"none"},id:"file",onChange:e=>{handleImageChange(e),g(!0)}})]}),u&&(0,a.jsx)("div",{className:"mr-2",children:(0,a.jsx)("button",{className:"text-blue-500 underline cursor-pointer",onClick:()=>g(!0)})}),m&&(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:(0,a.jsxs)("div",{className:"bg-gray-800 p-4 rounded text-white",children:[(0,a.jsx)("p",{className:"justify-center",children:"Image Selected"}),(0,a.jsx)("button",{className:"bg-blue-500 text-white font-bold py-2 px-4 rounded mr-2",onClick:handleSend,children:"Send"}),(0,a.jsx)("button",{className:"bg-gray-700 text-white font-bold py-2 px-4 rounded",onClick:()=>{h(null),g(!1)},children:"Cancel"})]})}),(0,a.jsx)("div",{className:"bg-gray-800 hover:bg-gray-400 text-white font-bold py-2 px-4 rounded cursor-pointer",onClick:handleSend,children:"Send"})]})};let capitalizeFirstLetter=e=>e.replace(/\b\w/g,e=>e.toUpperCase());var components_Chat=()=>{var e;let{data:t}=(0,n.Q)();console.log("data Latest => ",t);let s=(null===(e=t.Nuser)||void 0===e?void 0:e.displayName)||"",r=s?capitalizeFirstLetter(s):"Chat Window";return(0,a.jsxs)("div",{className:"w-596 overflow-hidden flex flex-col bg-gray-200",style:{height:"43rem"},children:[(0,a.jsxs)("div",{className:"p-4 bg-gray-700",children:[(0,a.jsx)("span",{className:"font-semibold text-lg text-white",children:r}),(0,a.jsx)("hr",{className:"border-t border-white mt-2"})]}),(0,a.jsx)("div",{className:"flex-grow overflow-y-auto bg-gray-700",children:(0,a.jsx)(components_ChatMessages,{})}),(0,a.jsx)(components_ChatInput,{})]})}},4031:function(e,t,s){"use strict";s.d(t,{H:function(){return AuthContextProvider},_:function(){return UserAuth}});var a=s(7437),r=s(2265),l=s(3085),n=s(6085),o=s(4086),i=s(9213);let c=(0,r.createContext)(),AuthContextProvider=e=>{let{children:t}=e,[s,d]=(0,r.useState)(null),[u,h]=(0,r.useState)(!1),handleSendEmailLink=async e=>{let t=(0,l.v0)(),s={url:window.location.origin,handleCodeInApp:!0};try{console.log("dropping mail",s),(0,l.oo)(t,e,s).then(()=>{window.localStorage.setItem("emailForSignIn",e),console.log("Email link sent. Check your email to sign in.")}).catch(e=>{e.code,e.message,console.error("Error sending email link:",e)})}catch(e){console.error("Error sending email link - :",e)}};(0,r.useEffect)(()=>{let e=(0,l.Aj)(n.I8,e=>{d(e)});return e},[s]);let saveUserDetails=async e=>{console.log({user:e}),e.displayName||(e.displayName=e.email.split("@")[0]);let t={displayName:e.displayName.toLowerCase(),email:e.email,uid:e.uid},s=(0,o.JU)(n.db,"users",e.uid),a=(0,o.JU)(n.db,"userChats",e.uid);try{let e=await (0,o.QT)(s);e.exists()?console.log("User document already exists. Skipping creation."):(await (0,o.pl)(s,t),console.log("User document written successfully."));let r=await (0,o.QT)(a);r.exists()?console.log("UserChats document already exists. Skipping creation."):(await (0,o.pl)(a,{}),console.log("UserChats document written successfully."))}catch(e){console.error("Error adding document: ",e)}};return(0,a.jsx)(c.Provider,{value:{user:s,isAdmin:u,setIsAdmin:h,googleSignIn:()=>{let e=new l.hJ;(0,l.rh)(n.I8,e).then(e=>{saveUserDetails(e.user)}).catch(e=>{console.error(e)})},logOut:()=>{(0,l.w7)(n.I8)},handleSendEmailLink,saveUserDetails},children:(0,a.jsx)(i.R,{children:t})})},UserAuth=()=>(0,r.useContext)(c)},9213:function(e,t,s){"use strict";s.d(t,{Q:function(){return ChatAuth},R:function(){return ChatContextProvider}});var a=s(7437),r=s(2265);s(3085),s(6085),s(4086),s(2209);var l=s(4031);let n=(0,r.createContext)(),ChatContextProvider=e=>{let{children:t}=e,{user:s}=(0,l._)(),[o,i]=(0,r.useReducer)((e,t)=>"CHANGE_USER"===t.type?{Nuser:t.payload,chatId:s.uid>t.payload.uid?s.uid+t.payload.uid:t.payload.uid+s.uid}:e,{chatId:"null",Nuser:{}});return(0,a.jsx)(n.Provider,{value:{data:o,dispatch:i},children:t})},ChatAuth=()=>(0,r.useContext)(n)},6085:function(e,t,s){"use strict";s.d(t,{I8:function(){return c},db:function(){return d},tO:function(){return u}});var a=s(3085),r=s(994),l=s(5073),n=s(4086),o=s(9584);let i=(0,r.ZF)({apiKey:"AIzaSyBuAHsQuDml9p5BZpM8qhmUh4r893hXzA8",authDomain:"trademate-ccec1.firebaseapp.com",projectId:"trademate-ccec1",storageBucket:"trademate-ccec1.appspot.com",messagingSenderId:"579948238014",appId:"1:579948238014:web:531bb2e2b28cafe6a2baef",measurementId:"G-ZWJ9YVY5T8"});(0,l.Gb)().then(e=>e?(0,l.IH)(i):null);let c=(0,a.v0)(i),d=(0,n.ad)(i),u=(0,o.cF)(i)}},function(e){e.O(0,[358,214,564,971,864,744],function(){return e(e.s=325)}),_N_E=e.O()}]);