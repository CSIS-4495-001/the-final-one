(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[209],{32:function(e,t,s){Promise.resolve().then(s.bind(s,7758))},7758:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return page}});var a=s(7437),l=s(4033),r=s(4031),o=s(2265),n=s(4086),i=s(6085),Posts_ReportedPosts=()=>{let{user:e,isAdmin:t}=(0,r._)(),[s,l]=(0,o.useState)([]),[d,c]=(0,o.useState)(Array(s.length).fill(0));(0,o.useEffect)(()=>{let fetchReportedPosts=async()=>{if(e){let e=(0,n.IO)((0,n.hJ)(i.db,"reportedPosts"));try{let t=await (0,n.PL)(e);if(t.empty)console.log("No posts found for the user");else{console.log("Total posts",t.docs.length);let e=[];t.forEach(t=>{let s=t.data();e.push(s)}),console.log({postsData:e}),l(e),c(Array(e.length).fill(0))}}catch(e){console.log("Error fetching user posts:",e)}}else console.log("Waiting for user")};fetchReportedPosts()},[e]);let nextImage=e=>{c(t=>{var a,l;let r=[...t];return r[e]=(r[e]+1)%((null===(l=s[e])||void 0===l?void 0:null===(a=l.postDetails.images)||void 0===a?void 0:a.length)||1),r})},prevImage=e=>{c(t=>{var a,l,r,o;let n=[...t];return n[e]=(n[e]-1+((null===(l=s[e])||void 0===l?void 0:null===(a=l.postDetails.images)||void 0===a?void 0:a.length)||1))%((null===(o=s[e])||void 0===o?void 0:null===(r=o.postDetails.images)||void 0===r?void 0:r.length)||1),n})},handleDelete=async e=>{if(console.log("Deleting post with ID:",e),window.confirm("Are you sure you want to delete this post?"))try{let t=(0,n.IO)((0,n.hJ)(i.db,"posts"),(0,n.ar)("postId","==",e)),s=(0,n.IO)((0,n.hJ)(i.db,"reportedPosts"),(0,n.ar)("postDetails.postId","==",e)),a=await (0,n.PL)(t),r=await (0,n.PL)(s);if(r.empty||await (0,n.oe)(r.docs[0].ref),a.empty)console.error("Document does not exist");else{let t=a.docs[0],s=t.data(),l=(0,n.JU)(i.db,"deletedPosts",e);await (0,n.pl)(l,s),await (0,n.oe)(t.ref)}l(t=>{let s=t.filter(t=>t.postDetails.postId!==e);return s})}catch(e){console.error("Error deleting document: ",e)}},handleIgnore=async e=>{if(console.log("Deleting post with ID:",e),window.confirm("Are you sure you want to ignore this post?"))try{let t=(0,n.IO)((0,n.hJ)(i.db,"reportedPosts"),(0,n.ar)("postDetails.postId","==",e)),s=await (0,n.PL)(t);s.empty||await (0,n.oe)(s.docs[0].ref),l(t=>{let s=t.filter(t=>t.postDetails.postId!==e);return s})}catch(e){console.error("Error deleting document: ",e)}};return(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 text-black mx-auto max-w-screen-lg px-8 pt-5 pb-3",children:0===s.length?(0,a.jsx)("p",{className:"text-center text-gray-500",children:"No reported posts available"}):s.map((e,t)=>(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-md overflow-hidden relative",children:[e.postDetails.images&&e.postDetails.images.length>0&&(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("img",{className:"w-full h-60 object-cover rounded-t-md",src:e.postDetails.images[d[t]],alt:"Image ".concat(d[t])}),e.postDetails.images.length>1&&(0,a.jsxs)("div",{className:"absolute top-0 right-0 flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>prevImage(t),className:"bg-gray-200 text-gray-700 p-2",children:"<"}),(0,a.jsx)("button",{onClick:()=>nextImage(t),className:"bg-gray-200 text-gray-700 p-2",children:">"})]})]}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h1",{className:"text-xl font-semibold mb-2 text-gray-900",children:e.postDetails.title}),(0,a.jsx)("p",{className:"text-gray-700 mb-4",children:e.postDetails.description}),(0,a.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,a.jsx)("svg",{height:"15pt",viewBox:"0 0 24 24",width:"15pt",xmlns:"http://www.w3.org/2000/svg",fill:"#000000",children:(0,a.jsx)("path",{d:"M18,4.48a8.45,8.45,0,0,0-12,12l5.27,5.28a1,1,0,0,0,1.42,0L18,16.43A8.45,8.45,0,0,0,18,4.48ZM16.57,15,12,19.59,7.43,15a6.46,6.46,0,1,1,9.14,0ZM9,7.41a4.32,4.32,0,0,0,0,6.1,4.31,4.31,0,0,0,7.36-3,4.24,4.24,0,0,0-1.26-3.05A4.3,4.3,0,0,0,9,7.41Zm4.69,4.68a2.33,2.33,0,1,1,.67-1.63A2.33,2.33,0,0,1,13.64,12.09Z"})}),(0,a.jsx)("p",{className:"ml-2 text-sm",children:e.postDetails.location})]}),(0,a.jsxs)("p",{className:"text-green-900 font-semibold text-lg mt-4",children:["$",e.postDetails.price]}),(0,a.jsxs)("div",{className:"pl-2",children:[(0,a.jsx)("h2",{className:"text-gray-900 font-semibold",children:"Reasons"}),(0,a.jsx)("div",{className:"bg-gray-200 rounded-md p-3",children:Array.isArray(e.reason)&&e.reason.length>0?(0,a.jsx)("ol",{className:"pl-5 text-gray-700 list-decimal",children:e.reason.map((e,t)=>(0,a.jsx)("li",{children:e},t))}):(0,a.jsx)("p",{children:"No reasons available"})})]}),(0,a.jsxs)("div",{className:"flex flex-col space-y-2 mt-2",children:[(0,a.jsx)("button",{onClick:()=>e.postDetails.postId&&handleDelete(e.postDetails.postId),type:"button",className:"text-white-400 bg-red-600 hover:bg-gray-200 hover:text-gray-900 rounded-sm text-sm p-2 inline-flex items-center justify-center w-full",children:(0,a.jsx)("span",{title:"Delete this post",children:"Delete"})}),(0,a.jsx)("button",{onClick:()=>handleIgnore(e.postDetails.postId),type:"button",className:"text-white-400 bg-green-600 hover:bg-gray-200 hover:text-gray-900 rounded-sm text-sm p-2 inline-flex items-center justify-center w-full",children:(0,a.jsx)("span",{title:"Ignore this post",children:"Ignore"})})]})]})]},t))})},page=()=>{let{user:e}=(0,r._)();return(0,l.useRouter)(),(0,a.jsx)("div",{className:"flex flex-1 items-center justify-center p-6",children:(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(Posts_ReportedPosts,{})})})})}},2209:function(e,t,s){"use strict";s.d(t,{Z:function(){return components_Chat}});var a=s(7437),l=s(2265),r=s(4031),o=s(9213),components_ChatMessage=e=>{let{message:t}=e,s=!1,{user:n}=(0,r._)(),{data:i}=(0,o.Q)(),d=(0,l.useRef)(null);(0,l.useEffect)(()=>{var e;null===(e=d.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[t]);let c=new Date(1e3*t.date.seconds);return s=!!n&&t.senderId===n.uid,(0,a.jsxs)("div",{ref:d,className:"flex ".concat(s?"justify-end":"justify-start"," items-center mb-4 ml-2 mr-2"),children:[s&&(0,a.jsx)("p",{className:"text-xs text-gray-400 ml-2 mr-2",children:c.toLocaleString()}),(0,a.jsxs)("div",{className:"max-w-[70%] p-3 rounded-lg ".concat(s?"bg-gray-800 text-white shadow-lg":"bg-gray-400 text-black shadow-lg"," ").concat(s?"float-right":"float-left"),children:[t.text.split("\n").map((e,t)=>(0,a.jsx)("p",{children:e},t)),t.image&&(0,a.jsx)("img",{src:null==t?void 0:t.image,alt:"",className:"mt-2 rounded-md w-full h-auto"})]}),!s&&(0,a.jsx)("p",{className:"text-xs text-gray-500 ml-2 mr-2",children:c.toLocaleString()})]})},n=s(4086),i=s(6085),components_ChatMessages=()=>{let[e,t]=(0,l.useState)([]),{data:s}=(0,o.Q)();return(0,l.useEffect)(()=>{let e=(0,n.cf)((0,n.JU)(i.db,"chats",s.chatId),e=>{e.exists()&&t(e.data().messages)});return()=>{e()}},[s.chatId]),console.log("messages => ",e),(0,a.jsx)("div",{children:e.map(e=>(0,a.jsx)(components_ChatMessage,{message:e},e.id))})},d=s(9584);let{v4:c}=s(4916);var components_ChatInput=()=>{let e=c(),[t,s]=(0,l.useState)(" "),[u,h]=(0,l.useState)(null),[m,g]=(0,l.useState)(!1),{user:p}=(0,r._)(),{data:x}=(0,o.Q)(),handleSend=async()=>{if(u){let s=(0,d.iH)(i.tO,"chats/"+e),a=(0,d.B0)(s,u);a.on("state_changed",e=>{},e=>{console.error(e)},()=>{(0,d.Jt)(a.snapshot.ref).then(async s=>{await (0,n.r7)((0,n.JU)(i.db,"chats",x.chatId),{messages:(0,n.vr)({id:e,text:t,senderId:p.uid,date:n.EK.now(),image:s})})})})}else await (0,n.r7)((0,n.JU)(i.db,"chats",x.chatId),{messages:(0,n.vr)({id:e,text:t,senderId:p.uid,date:n.EK.now()})});await (0,n.r7)((0,n.JU)(i.db,"userChats",p.uid),{[x.chatId+".lastMessage"]:{text:t},[x.chatId+".date"]:(0,n.Bt)()}),await (0,n.r7)((0,n.JU)(i.db,"userChats",x.Nuser.uid),{[x.chatId+".lastMessage"]:{text:t},[x.chatId+".date"]:(0,n.Bt)()}),s(""),h(null),g(!1)},handleImageChange=e=>{var t;let s=(null===(t=e.target.files)||void 0===t?void 0:t[0])||null;h(s)};return(0,a.jsxs)("div",{className:"bottom-0 left-0 w-full bg-gray-700 flex items-center ",children:[(0,a.jsx)("input",{type:"text",placeholder:"Enter your message...",className:"w-full border border-gray-800 p-4 mr-2 rounded focus:outline-none focus:border-gray-500 text-white bg-gray-800",onChange:e=>s(e.target.value),onKeyDown:e=>{"Enter"===e.key&&handleSend()},value:t}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("label",{htmlFor:"file",className:"cursor-pointer",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-800 hover:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),(0,a.jsx)("input",{type:"file",style:{display:"none"},id:"file",onChange:e=>{handleImageChange(e),g(!0)}})]}),u&&(0,a.jsx)("div",{className:"mr-2",children:(0,a.jsx)("button",{className:"text-blue-500 underline cursor-pointer",onClick:()=>g(!0)})}),m&&(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:(0,a.jsxs)("div",{className:"bg-gray-800 p-4 rounded text-white",children:[(0,a.jsx)("p",{className:"justify-center",children:"Image Selected"}),(0,a.jsx)("button",{className:"bg-blue-500 text-white font-bold py-2 px-4 rounded mr-2",onClick:handleSend,children:"Send"}),(0,a.jsx)("button",{className:"bg-gray-700 text-white font-bold py-2 px-4 rounded",onClick:()=>{h(null),g(!1)},children:"Cancel"})]})}),(0,a.jsx)("div",{className:"bg-gray-800 hover:bg-gray-400 text-white font-bold py-2 px-4 rounded cursor-pointer",onClick:handleSend,children:"Send"})]})};let capitalizeFirstLetter=e=>e.replace(/\b\w/g,e=>e.toUpperCase());var components_Chat=()=>{var e;let{data:t}=(0,o.Q)();console.log("data Latest => ",t);let s=(null===(e=t.Nuser)||void 0===e?void 0:e.displayName)||"",l=s?capitalizeFirstLetter(s):"Chat Window";return(0,a.jsxs)("div",{className:"w-596 overflow-hidden flex flex-col bg-gray-200",style:{height:"43rem"},children:[(0,a.jsxs)("div",{className:"p-4 bg-gray-700",children:[(0,a.jsx)("span",{className:"font-semibold text-lg text-white",children:l}),(0,a.jsx)("hr",{className:"border-t border-white mt-2"})]}),(0,a.jsx)("div",{className:"flex-grow overflow-y-auto bg-gray-700",children:(0,a.jsx)(components_ChatMessages,{})}),(0,a.jsx)(components_ChatInput,{})]})}},4031:function(e,t,s){"use strict";s.d(t,{H:function(){return AuthContextProvider},_:function(){return UserAuth}});var a=s(7437),l=s(2265),r=s(3085),o=s(6085),n=s(4086),i=s(9213);let d=(0,l.createContext)(),AuthContextProvider=e=>{let{children:t}=e,[s,c]=(0,l.useState)(null),[u,h]=(0,l.useState)(!1),handleSendEmailLink=async e=>{let t=(0,r.v0)(),s={url:window.location.origin,handleCodeInApp:!0};try{console.log("dropping mail",s),(0,r.oo)(t,e,s).then(()=>{window.localStorage.setItem("emailForSignIn",e),console.log("Email link sent. Check your email to sign in.")}).catch(e=>{e.code,e.message,console.error("Error sending email link:",e)})}catch(e){console.error("Error sending email link - :",e)}};(0,l.useEffect)(()=>{let e=(0,r.Aj)(o.I8,e=>{c(e)});return e},[s]);let saveUserDetails=async e=>{console.log({user:e}),e.displayName||(e.displayName=e.email.split("@")[0]);let t={displayName:e.displayName.toLowerCase(),email:e.email,uid:e.uid},s=(0,n.JU)(o.db,"users",e.uid),a=(0,n.JU)(o.db,"userChats",e.uid);try{let e=await (0,n.QT)(s);e.exists()?console.log("User document already exists. Skipping creation."):(await (0,n.pl)(s,t),console.log("User document written successfully."));let l=await (0,n.QT)(a);l.exists()?console.log("UserChats document already exists. Skipping creation."):(await (0,n.pl)(a,{}),console.log("UserChats document written successfully."))}catch(e){console.error("Error adding document: ",e)}};return(0,a.jsx)(d.Provider,{value:{user:s,isAdmin:u,setIsAdmin:h,googleSignIn:()=>{let e=new r.hJ;(0,r.rh)(o.I8,e).then(e=>{saveUserDetails(e.user)}).catch(e=>{console.error(e)})},logOut:()=>{(0,r.w7)(o.I8)},handleSendEmailLink,saveUserDetails},children:(0,a.jsx)(i.R,{children:t})})},UserAuth=()=>(0,l.useContext)(d)},9213:function(e,t,s){"use strict";s.d(t,{Q:function(){return ChatAuth},R:function(){return ChatContextProvider}});var a=s(7437),l=s(2265);s(3085),s(6085),s(4086),s(2209);var r=s(4031);let o=(0,l.createContext)(),ChatContextProvider=e=>{let{children:t}=e,{user:s}=(0,r._)(),[n,i]=(0,l.useReducer)((e,t)=>"CHANGE_USER"===t.type?{Nuser:t.payload,chatId:s.uid>t.payload.uid?s.uid+t.payload.uid:t.payload.uid+s.uid}:e,{chatId:"null",Nuser:{}});return(0,a.jsx)(o.Provider,{value:{data:n,dispatch:i},children:t})},ChatAuth=()=>(0,l.useContext)(o)},6085:function(e,t,s){"use strict";s.d(t,{I8:function(){return d},db:function(){return c},tO:function(){return u}});var a=s(3085),l=s(994),r=s(5073),o=s(4086),n=s(9584);let i=(0,l.ZF)({apiKey:"AIzaSyBuAHsQuDml9p5BZpM8qhmUh4r893hXzA8",authDomain:"trademate-ccec1.firebaseapp.com",projectId:"trademate-ccec1",storageBucket:"trademate-ccec1.appspot.com",messagingSenderId:"579948238014",appId:"1:579948238014:web:531bb2e2b28cafe6a2baef",measurementId:"G-ZWJ9YVY5T8"});(0,r.Gb)().then(e=>e?(0,r.IH)(i):null);let d=(0,a.v0)(i),c=(0,o.ad)(i),u=(0,n.cF)(i)},4033:function(e,t,s){e.exports=s(290)}},function(e){e.O(0,[358,214,564,971,864,744],function(){return e(e.s=32)}),_N_E=e.O()}]);